# 5.4.条件与断言

## 1. 真值 (布尔值)

- 标准真值 `True` 和 `False`
    - `True`和`False`是1和0的别名, 可以用作1和0
    - 在旧版本Python中, 返回1和0的表达式意味着`True`和`False`
- 任何值都可解释 (转换) 为真值
    - Python会自动将其他类型的值转换为`bool`型
- 下列值转换为假: `False None 0 '' () [] {}`
    - 标准真值`False`
    - `None`
    - 数值`0`
    - 空序列`'' () []`
    - 空映射`{}`
- 除此之外的一切内置类型值 (包括标准真值`True`) 都转换为真
- 自定义类型的值转换为真或假由类型定义决定
- 注意: 对应真值相等的值本身并不一定相等: `bool([]) == bool('')`, `[] != ''`

## 2. 条件执行与if语句

- if语句: 条件执行代码
    - 条件: `if`与冒号`:`之间的表达式
    - 若条件为真, 则执行后续代码 (块); 若条件为假, 则不执行
    - 除了使用代码块, 也可以将条件执行的语句与if语句放在同一行中

```python3
if condition:
    codeblock

if condition: code
```

## 3. else子句

- 子句: 不是独立的语句, 只能作为其他语句的一部分
- else子句: 若当前if语句中之前的代码块都没有执行, 则执行else之后的代码块
    - if语句中的else子句是可选的
    - 一个if语句中最多只能有一个else子句

```python3
if condition:
    codeblock
else:
    codeblock
```

- 条件表达式: `true_value if condition else false_value`
    - 使用if与else确定值的表达式: 若条件为真, 则值为`true_value`, `false_value`不会被计算; 若条件为假, 则值为`false_value`, `true_value`不会被计算
    - 类似于C中的三目运算符`?:`

## 4. elif子句

- elif子句: 用于检查多个条件
    - elif是else if的缩写, 即包含条件的else子句
    - 若当前if语句中之前的代码块都没有执行, 且条件为真, 则执行elif之后的代码块
    - 等价于一个else子句与一个if语句的组合
- if语句中的elif子句是可选的
- 一个if语句中可以有任意数量个elif子句

```python3
if condition:
    codeblock(
elif condition:
    codeblock)*(
else condition:
    codeblock)?

# Equivalent to
if condition:
    codeblock(
else:
    if condition:
        codeblock)*(
    else:
        codeblock)
```

## 5. 代码块嵌套

- 任何语句都可以作为代码块的一部分
    - 例如, if语句可以作为另一个if语句的代码块的一部分

## 6. 更复杂的条件

### 6.1. 比较运算符

- 比较运算符: 用于执行比较, 运算结果是布尔值`bool`
    - `x == y`: 相等性检验: x等于y
    - `x != y`: 不等性检验: x不等于y
    - `x < y`: 小于性检验: x小于y
    - `x <= y`: 小于等于性检验: x小于或等于y
    - `x > y`: 大于性检验: x大于y
    - `x >= y`: 大于等于性检验: x大于或等于y
    - `x is y`: 相同性检验: x是y, x与y是同一个对象
    - `x is not y`: 不同性检验: x不是y, x与y是不同的对象
    - `x in y`: 成员资格检验: x是容器y的成员
    - `x not in y`: 非成员资格检验: x不是容器y的成员
- 不允许比较不兼容的类型
- 链式比较: 同时使用多个比较运算符: `value( op value)*`
    - 每个比较运算符与其相邻的两运算对象组成的条件均为真时, 链式比较才为真

#### 6.1.1. 相等运算符

- 检查两个对象是否相等: `var == var`
- 注意: `=`是赋值运算符, 用于修改而非比较值

#### 6.1.2. 相同运算符

- 相等与相同
    - 相等: 值, 结构, 状态相同
    - 相同: 是同一个对象
    - 值相等的两个变量可能引用不同对象; 引用相同对象的两个变量的值一定相等
- `==`与`is`不同
    - `==`: 相等性检验: 检查两对象是否相等, 而非相同
    - `is`: 相同性检验: 检查两对象是否相同, 而非相等
- 注意: 将`is`用于数值与字符串等不可变基本值时, 由于Python的内部处理方式, 结果是不可预测的

#### 6.1.3. 成员资格运算符

#### 6.1.4. 字符串和序列的比较

- 字符串根据字符的Unicode码点进行字典序比较
- `ord(one_character_string) -> int`: 返回单字符字符串中字符的Unicode码点
- `chr(unicode_code_point) -> str`: 返回Unicode码点对应的单字符字符串
- 注意: 大写字母的Unicode码点小于小写字母的Unicode码点
    - 可通过`str.lower()`进行忽略大小写的比较
- 序列根据元素值进行字典序比较
- 若序列的元素也是序列, 根据同样的规则进行递归比较

### 6.2. 布尔运算符

- 考虑到所有类型的值都可解释为真值, 所有表达式都返回可以解释为真值的值
- 布尔运算符用于组合真值
    - `and`: 且: 左右运算对象都为真时返回真, 否则返回假
    - `or`: 或: 左右运算对象都为假时返回假, 否则返回真
    - `not`: 非: 右运算对象为假时返回真, 否则返回假
- 短路逻辑 (延迟求值): 布尔运算符只做必要的计算
    - `x and y`: 若x为假, 返回x; 若x为真, 返回y
        - 当x为假时, **y不会被执行**
    - `x or y`: 若x为真, 返回x; 若x为假, 返回y
        - 当x为真时, **y不会被执行**
- `any(iterable) -> bool`: 内置函数, 当`iterable`中任意元素为真时返回真, 否则返回假
- `all(iterable) -> bool`: 内置函数, 当`iterable`中所有元素都为真时返回真, 否则返回假

## 7. 断言

- 让程序在出错时立即崩溃好过错误放大传递后再崩溃
- assert语句: 要求指定条件得到满足, 若条件为假, 引发`AssertionError` (并打印断言说明字符串): `assert condition(, assertion_description_string)?`
- 用途: 检查点: 程序必须满足特定条件才能正确运行时的检查
    - 检验函数参数满足要求 (鸭子模型)
    - 测试与调试
